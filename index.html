<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.min.js"></script>

<script>
const form = document.getElementById('formulario');
const cpf = document.getElementById('cpf');

// Máscara do CPF
function mascaraCPF(cpf) {
    cpf = cpf.replace(/\D/g, '');
    cpf = cpf.replace(/(\d{3})(\d)/, '$1.$2');
    cpf = cpf.replace(/(\d{3})(\d)/, '$1.$2');
    cpf = cpf.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
    return cpf;
}

cpf.addEventListener('input', function(e) {
    e.target.value = mascaraCPF(e.target.value);
});

// Validação de email
function validarEmail(email) {
    const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return regex.test(email);
}

// Validação de senha
function validarSenha(senha) {
    return senha.length >= 6;
}

form.addEventListener('submit', function(e) {
    e.preventDefault();
    
    const numerosCPF = cpf.value.replace(/\D/g, '');
    const email = form.querySelector('input[type="email"]').value;
    const emailConfirmacao = form.querySelectorAll('input[type="email"]')[1].value;
    const senha = form.querySelector('input[type="password"]').value;
    const senhaConfirmacao = form.querySelectorAll('input[type="password"]')[1].value;
    
    // Validações
    if (numerosCPF.length !== 11) {
        alert('CPF inválido! Deve conter exatamente 11 números.');
        cpf.focus();
        return;
    }
    
    if (!validarEmail(email)) {
        alert('Por favor, insira um e-mail válido.');
        return;
    }
    
    if (email !== emailConfirmacao) {
        alert('Os e-mails não coincidem!');
        return;
    }
    
    if (!validarSenha(senha)) {
        alert('A senha deve ter pelo menos 6 caracteres.');
        return;
    }
    
    if (senha !== senhaConfirmacao) {
        alert('As senhas não coincidem!');
        return;
    }
    
    // Salvar dados no localStorage
    const dadosAcesso = {
        nome: form.querySelector('input[type="text"]').value,
        cpf: cpf.value,
        email: email,
        senha: senha
    };
    
    localStorage.setItem('dadosAcesso', JSON.stringify(dadosAcesso));
    
    // Redirecionar para próxima página
    window.location.href = 'unidade-e-curso.html';
});

// Carregar dados salvos se existirem
document.addEventListener('DOMContentLoaded', function() {
    const dadosSalvos = localStorage.getItem('dadosAcesso');
    if (dadosSalvos) {
        const dados = JSON.parse(dadosSalvos);
        form.querySelector('input[type="text"]').value = dados.nome || '';
        cpf.value = dados.cpf || '';
        form.querySelector('input[type="email"]').value = dados.email || '';
        form.querySelectorAll('input[type="email"]')[1].value = dados.email || '';
    }
});
</script>
