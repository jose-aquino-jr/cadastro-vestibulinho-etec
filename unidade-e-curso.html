<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Área do Candidato - Etec</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="estilo-unidade-e-curso.css">
</head>

<body>
    <div class="fundo">

        <header class="top-header">
            <div class="container-fluid d-flex align-items-center justify-content-between py-3">
                <div class="caixa-gov d-flex align-items-center">
                    <img src="images-removebg-preview.png" alt="Logo Governo" class="logo-gov">
                </div>

                <div class="flex-fill"></div>

                <div class="redes-wrap d-flex align-items-center">
                    <img src="redes.jfif" alt="Redes" class="redes-logo">
                </div>
            </div>

            <div class="linha"></div>
        </header>

        <div class="caixa-fixa">
            <div class="container-fluid d-flex align-items-center justify-content-between py-2">
                <div class="d-flex align-items-center">
                    <img src="etec_cps-removebg-preview.png" alt="Etec" class="logo-etec-cps">
                </div>

                <nav class="main-nav">
                    <ul class="nav list-unstyled d-flex gap-4 mb-0">
                        <li><a class="nav-link" href="#">HOME</a></li>
                        <li><a class="nav-link" href="#">CALENDÁRIO</a></li>
                        <li><a class="nav-link" href="#">DÚVIDAS FREQUENTES</a></li>
                        <li><a class="nav-link" href="#">FALE CONOSCO</a></li>
                    </ul>
                </nav>

                <div class="d-flex align-items-center gap-3">
                    <button class="btn btn-danger btn-sm btn-area d-flex align-items-center gap-2 px-3" aria-label="Área do Candidato">
                        Área do candidato
                        <img src="image-removebg-preview.png" width="20" alt="Ícone de área do candidato">
                    </button>

                    <div class="bloco">
                        <div class="realizacao">
                            <span>Realização:</span>
                            <img src="FAT-FUNDACAO-DE-APOIO-A-TECNOLOGIA.webp" alt="FAT" class="realizacao-logo">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <section class="imagem-banner">
            <img src="highlight-bg.jpg" alt="Imagem destaque" class="img-fluid w-100">
        </section>

        <main class="container py-5">
            <div class="vermelho">
                <div class="vermelho-word">Inscrição</div>
            </div>
            <div class="conteudo">
                <div class="cinza"></div>
                <div class="cinza-plus"></div>
                <div class="container-botoes">

                    <div class="grupo">
                        <button class="btn-circular">✓</button>
                        <span class="labele">Dados de acesso</span>
                    </div>

                    <div class="grupo">
                        <button class="btn-circular ativo">2</button>
                        <span class="labele">Unidade e curso</span>
                    </div>

                    <div class="grupo">
                        <button class="btn-circular">3</button>
                        <span class="labele">Dados pessoais</span>
                    </div>

                    <div class="grupo">
                        <button class="btn-circular">4</button>
                        <span class="labele">Pont. acrescida</span>
                    </div>

                    <div class="grupo">
                        <button class="btn-circular">5</button>
                        <span class="labele">Confirmação</span>
                    </div>

                    <div class="grupo">
                        <button class="btn-circular">6</button>
                        <span class="labele">Questionário</span>
                    </div>

                    <div class="grupo">
                        <button class="btn-circular">7</button>
                        <span class="labele">Conclusão</span>
                    </div>

                </div>
                <p class="palavras">
                    Para iniciar a inscrição para Processo Seletivo Vestibulinho 1º semestre de 2026 selecione abaixo o município da Etec / Extensão de Etec em que pretende estudar.
                </p>

                <div class="row d-flex justify-content-center">
                    <div class="col-12 col-lg-10">
                        <form id="form-inscricao">
                            <label class="form-label bloco-titulo d-block">O candidato é treineiro?</label>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="treineiro" id="nao" value="Nao" checked>
                                <label class="form-check-label" for="nao">Não</label>
                            </div>
                            <div class="form-check form-check-inline mb-4">
                                <input class="form-check-input" type="radio" name="treineiro" id="sim" value="Sim">
                                <label class="form-check-label" for="sim">Sim</label>
                            </div>

                            <p class="text-secondary mb-4" style="font-size: 14px; padding: 10px; border-left: 3px solid #b10505;">
                                Treineiro é um estudante que ainda não tem os requisitos de ingresso para o Ensino Médio (não irá concluir o ensino fundamental no final de 2025) e deseja participar do exame do Vestibulinho, para ganhar experiência com o formato da prova, familiarizar-se com o ambiente e testar seus conhecimentos, o que o ajuda a se preparar para futuras provas que realmente contarão para sua aprovação.
                            </p>

                            <label class="form-label bloco-titulo">Município da Etec / Extensão de Etec</label>
                            <select class="form-select mb-4 campo-select" id="municipio" required>
                                <option value="" selected disabled>Carregando municípios...</option>
                            </select>

                            <div id="bloco-curso-detalhado" style="display: block;">
                                <label class="form-label bloco-titulo">Modalidade</label>
                                <select class="form-select mb-3 campo-select" id="modalidade" required>
                                    <option value="" selected disabled>Selecione a modalidade de ensino desejada</option>
                                    <option value="ensino-medio">Ensino Médio</option>
                                    <option value="ensino-medio-integrado">Ensino Médio Integrado</option>
                                    <option value="ensino-medio-eja">Ensino Médio - EJA</option>
                                    <option value="tecnico-integrado">Curso Técnico Integrado</option>
                                    <option value="tecnico-subsequente">Curso Técnico Subsequente</option>
                                    <option value="tecnico-concomitante">Curso Técnico Concomitante</option>
                                </select>
                                <p class="text-danger mb-4" style="font-size: 12px; margin-top: -8px; padding-left: 10px;"><img src="image-removebg-preview.png" width="10" alt=""> Saiba mais sobre as modalidades</p>

                                <label class="form-label bloco-titulo">Curso e período</label>
                                <select class="form-select mb-3 campo-select" id="curso-periodo" required>
                                    <option value="" selected disabled>Selecione primeiro a modalidade</option>
                                </select>
                                <div class="alert alert-warning mb-4" style="font-size: 14px; padding: 10px;">
                                    Selecione a unidade
                                </div>

                                <h3 class="mb-3 mt-4" style="font-size:20px; font-weight:600; color:#444;">2ª opção</h3>
                                <label class="form-label bloco-titulo">Selecione a 2ª opção de curso e período que pretende estudar.</label>
                                <select class="form-select mb-4 campo-select" id="segunda-opcao">
                                    <option value="" selected disabled>Selecione primeiro a modalidade</option>
                                </select>

                                <h3 class="mb-3 mt-4" style="font-size:20px; font-weight:600; color:#444;">Confirmação de pré-requisitos</h3>
                                <label class="form-label bloco-titulo d-block">1. Você já concluiu o Ensino Médio ou está matriculado na 3ª série do Ensino Médio no ano de 2025?<span class="text-danger">*</span></label>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="prerequisito" id="prerequisito_sim" value="Sim" required>
                                    <label class="form-check-label" for="prerequisito_sim">Sim</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="prerequisito" id="prerequisito_nao" value="Nao">
                                    <label class="form-check-label" for="prerequisito_nao">Não</label>
                                </div>
                            </div>

                            <div class="action-row mt-4">
    <button type="submit" class="btn-primary-custom">
        Salvar e ir para a próxima etapa
    </button>
    <button type="button" class="btn-secondary-custom">
        Sair e continuar inscrição depois
    </button>
</div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="conteudo-red"></div>
        </div>
        </main>

    </div>

    <footer class="footer">
        <div class="footer-tops"></div>

        <div class="footer-top">
            <p><a href="#">Todos os direitos reservados © 2025 FAT | </a>
                <a href="#">Política de Privacidade | </a>
                <a href="#">Termos de Uso</a>
            </p>
        </div>

        <div class="footer-mid">
            <img src="Captura_de_tela_2025-11-15_161028-removebg-preview.png" alt="atg" class="atge">
        </div>

        <div class="footer-buttons">
            <a class="btn-footer">Ouvidoria</a>
            <a class="btn-footer">Transparência</a>
            <a class="btn-footer">SIC</a>
        </div>

        <div class="footer-bottom">
            <img src="images-removebg-preview.png" alt="Governo de SP">
        </div>

    </footer>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

   <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<script>
document.addEventListener("DOMContentLoaded", async () => {
    const sim = document.getElementById("sim");
    const nao = document.getElementById("nao");
    const bloco = document.getElementById("bloco-curso-detalhado");
    const municipioSelect = document.getElementById("municipio");
    const modalidadeSelect = document.getElementById("modalidade");
    const cursoPeriodoSelect = document.getElementById("curso-periodo");
    const segundaOpcaoSelect = document.getElementById("segunda-opcao");
    const form = document.getElementById("form-inscricao");
    const btnProximaEtapa = document.querySelector('.btn-primary-custom');
    const btnSair = document.querySelector('.btn-secondary-custom');

    let todasEtecs = [];
    let todosCursos = [];

    // Carregar todas as ETECs da API
    async function carregarTodasEtecs() {
        try {
            const response = await axios.get('https://etecs-api.onrender.com/all');
            todasEtecs = response.data;
            console.log('ETECs carregadas:', todasEtecs.length);
            return true;
        } catch (error) {
            console.error('Erro ao carregar ETECs:', error);
            todasEtecs = await carregarFallbackEtecs();
            return false;
        }
    }

    async function carregarFallbackEtecs() {
        return [
            {
                name: "Etec de São Paulo - Centro",
                cidade: "São Paulo",
                cursos: [
                    { nome: "Administração - Matutino", periodo: "Manhã" },
                    { nome: "Informática - Vespertino", periodo: "Tarde" }
                ]
            },
            {
                name: "Etec de Santo André",
                cidade: "Santo André", 
                cursos: [
                    { nome: "Enfermagem - Integral", periodo: "Integral" },
                    { nome: "Marketing - Noturno", periodo: "Noite" }
                ]
            }
        ];
    }

    // Carregar cursos únicos da API
    async function carregarCursosUnicos() {
        try {
            const response = await axios.get('https://etecs-api.onrender.com/cursos');
            todosCursos = response.data;
            console.log('Cursos carregados:', todosCursos.length);
            return true;
        } catch (error) {
            console.error('Erro ao carregar cursos:', error);
            todosCursos = [
                "Administração", "Informática", "Enfermagem", "Marketing", "Ensino Médio"
            ];
            return false;
        }
    }

    // Carregar municípios disponíveis
    async function carregarMunicipios() {
        municipioSelect.innerHTML = '<option value="" selected disabled>Carregando municípios...</option>';
        
        const apiOnline = await carregarTodasEtecs();
        
        if (apiOnline && todasEtecs.length > 0) {
            const municipios = [...new Set(todasEtecs.map(etec => {
                const partes = etec.name.split(' - ');
                return partes[partes.length - 1];
            }))].sort();
            
            municipioSelect.innerHTML = '<option value="" selected disabled>Selecione o município da Etec</option>';
            municipios.forEach(municipio => {
                const option = document.createElement('option');
                option.value = municipio;
                option.textContent = municipio;
                municipioSelect.appendChild(option);
            });
        } else {
            const municipiosPadrao = [
                "São Paulo", "Santo André", "São Bernardo do Campo", 
                "São Caetano do Sul", "Guarulhos", "Campinas"
            ];
            
            municipioSelect.innerHTML = '<option value="" selected disabled>Selecione o município da Etec</option>';
            municipiosPadrao.forEach(municipio => {
                const option = document.createElement('option');
                option.value = municipio;
                option.textContent = municipio;
                municipioSelect.appendChild(option);
            });
        }
    }

    // Carregar cursos baseado na modalidade
    function carregarCursos(modalidade) {
        cursoPeriodoSelect.innerHTML = '<option value="" selected disabled>Carregando cursos...</option>';
        
        setTimeout(() => {
            let cursosFiltrados = [];
            
            switch(modalidade) {
                case 'ensino-medio':
                    cursosFiltrados = todosCursos.filter(curso => 
                        curso.toLowerCase().includes('ensino médio')
                    );
                    break;
                case 'tecnico-subsequente':
                    cursosFiltrados = todosCursos.filter(curso => 
                        !curso.toLowerCase().includes('ensino médio')
                    );
                    break;
                default:
                    cursosFiltrados = [...todosCursos];
            }
            
            cursoPeriodoSelect.innerHTML = '<option value="" selected disabled>Selecione o curso e o período</option>';
            
            if (cursosFiltrados.length === 0) {
                cursosFiltrados = ['Administração', 'Informática', 'Enfermagem'];
            }
            
            cursosFiltrados.forEach(curso => {
                const option = document.createElement('option');
                option.value = curso.toLowerCase().replace(/\s+/g, '-');
                option.textContent = curso;
                cursoPeriodoSelect.appendChild(option);
            });
        }, 500);
    }

    function atualizarVisibilidade() {
        if (sim.checked) {
            bloco.style.display = "none"; 
        } else {
            bloco.style.display = "block";
        }
    }

    // Event Listeners
    sim.addEventListener("change", atualizarVisibilidade);
    nao.addEventListener("change", atualizarVisibilidade);
    
    modalidadeSelect.addEventListener("change", function() {
        carregarCursos(this.value);
    });

    // Botão Próxima Etapa - CORREÇÃO PRINCIPAL
    btnProximaEtapa.addEventListener('click', async function(e) {
        e.preventDefault(); // Impede o comportamento padrão
        
        console.log('Botão clicado!'); // Debug
        
        if (!form.checkValidity()) {
            alert('Por favor, preencha todos os campos obrigatórios.');
            form.reportValidity();
            return;
        }
        
        // Salvar dados no localStorage
        const dadosUnidadeCurso = {
            treineiro: document.querySelector('input[name="treineiro"]:checked').value,
            municipio: municipioSelect.value,
            modalidade: modalidadeSelect.value,
            curso: cursoPeriodoSelect.value,
            segundaOpcao: segundaOpcaoSelect.value,
            prerequisito: document.querySelector('input[name="prerequisito"]:checked').value,
            timestamp: new Date().toISOString()
        };
        
        localStorage.setItem('dadosUnidadeCurso', JSON.stringify(dadosUnidadeCurso));
        
        console.log('Dados salvos, redirecionando...'); // Debug
        
        // Redirecionar - CORREÇÃO AQUI
        window.location.href = 'dados-pessoais.html';
    });

    // Botão Sair
    btnSair.addEventListener('click', function() {
        if (confirm('Deseja realmente sair? Seus dados serão salvos para continuar depois.')) {
            const dadosTemp = {
                treineiro: document.querySelector('input[name="treineiro"]:checked').value,
                municipio: municipioSelect.value,
                modalidade: modalidadeSelect.value,
                curso: cursoPeriodoSelect.value
            };
            localStorage.setItem('dadosTempUnidadeCurso', JSON.stringify(dadosTemp));
            window.location.href = 'index.html';
        }
    });

    // Inicialização
    await carregarMunicipios();
    await carregarCursosUnicos();
    atualizarVisibilidade();
    
    // Carregar dados salvos
    const dadosSalvos = localStorage.getItem('dadosUnidadeCurso');
    if (dadosSalvos) {
        const dados = JSON.parse(dadosSalvos);
        if (dados.treineiro === 'Sim') sim.checked = true;
        else nao.checked = true;
        
        municipioSelect.value = dados.municipio || '';
        modalidadeSelect.value = dados.modalidade || '';
        
        if (dados.modalidade) {
            carregarCursos(dados.modalidade);
            setTimeout(() => {
                cursoPeriodoSelect.value = dados.curso || '';
            }, 100);
        }
    }
});
</script>

</body>

</html>
